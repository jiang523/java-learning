![7f749fc8](../images/java各种锁总结/7f749fc8.png)

Java提供了非常丰富的锁来面对各种并发场景，不同的锁有着不同的特性。

- 悲观锁、乐观锁

  悲观锁和乐观锁的区别在于看待多线程数据同步的角度。

  悲观锁的方式认为一个线程在修改一个变量的时候，一定会存在其他的线程同时也在修改这个变量，必须保证要同步的变量同时只能被一个线程修改，即被获得锁的线程修改，其他线程只能等待。Java中，synchronized关键字和Lock的实现类都是悲观锁。

  乐观锁的方式认为一个线程在修改一个变量的时候不会有其他线程也在修改，只需要最后提交的时候判断一个这个变量有没有被修改过，如果没有修改过则把自己的修改提交，否则进行重试或报错。乐观锁在Java中是通过使用无锁编程来实现，最常采用的是CAS算法，Java原子类中的递增操作就通过CAS自旋实现的。

  从二者的概念来看，悲观锁更适合写操作多的场景，保证多个线程之间写的数据正确性。乐观锁更适合读的场景，其无锁的实现方式读数据性能非常好。

- CAS

  一种无锁算法，是乐观锁的一种实现，线程在操作一个变量时，当前变量值为V，线程读取该变量到线程私有内存，值为W，此时V==W，而后线程会对变量做修改，最后修改写回到内存时，会判断最开始读取的变量值W是否还是和变量的值相等，当且仅当二者相等时，线程修改的值才能写回内存。

- AQS

  AQS是一种抽象的队列同步器，它的核心思想是，基于一个虚拟的双向队列去实现锁的分配，用

- 自旋锁

- 偏向锁、重量级锁、轻量级锁

- 公平锁、非公平锁

- 重入锁

- 共享锁、排他锁

- 锁的升级